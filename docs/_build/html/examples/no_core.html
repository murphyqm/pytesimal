

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Planetesimal Without a Core &mdash; Pytesimal 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quick Start" href="quick_start.html" />
    <link rel="prev" title="Constant Properties" href="constant_properties.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Pytesimal
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Pytesimal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#quick-start">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#contribute">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#support">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#license">License</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="constant_properties.html">Constant Properties</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Planetesimal Without a Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="variable_properties.html">Variable Properties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apiref.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pytesimal</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Examples gallery</a> &raquo;</li>
        
      <li>Planetesimal Without a Core</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/no_core.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-no-core-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="planetesimal-without-a-core">
<span id="sphx-glr-examples-no-core-py"></span><h1>Planetesimal Without a Core<a class="headerlink" href="#planetesimal-without-a-core" title="Permalink to this headline">¶</a></h1>
<p>This example shows step by step how to set up and run a model of a cooling
planetesimal without a core. This example uses constant
material properties in the mantle, see
<a class="reference external" href="https://doi.org/10.1029/2020JE006726">Murphy Quinlan et
al. (2021)</a> and references therein.</p>
<p>While the material properties used in this example are suitable for modelling
the olivine mantle of a differentiated body, the model set-up may be useful
for modelling undifferentiated meteorite parent bodies with appropriate
thermal properties.</p>
<p>This model set-up also allows for comparison to an analytical solution for
conductive cooling in a sphere (see <a class="reference external" href="https://doi.org/10.1029/2020JE006726">Murphy Quinlan et
al. (2021)</a>).</p>
<p>As we’re setting this up step-by-step instead of using the
<cite>pytesimal.quick_workflow</cite> module, we need to import a
selection of modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytesimal.setup_functions</span>
<span class="kn">import</span> <span class="nn">pytesimal.load_plot_save</span>
<span class="kn">import</span> <span class="nn">pytesimal.numerical_methods</span>
<span class="kn">import</span> <span class="nn">pytesimal.analysis</span>
<span class="kn">import</span> <span class="nn">pytesimal.core_function</span>
<span class="kn">import</span> <span class="nn">pytesimal.mantle_properties</span>
</pre></div>
</div>
<p>Instead of creating and loading a parameter file, we’re going to
define variables here. The values match those of the constant
thermal properties case in Murphy Quinlan et al. (2021),
except for the <cite>core_size_factor</cite> value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">timestep</span> <span class="o">=</span> <span class="mf">1E11</span>  <span class="c1"># s</span>
<span class="n">r_planet</span> <span class="o">=</span> <span class="mf">250_000.0</span>  <span class="c1"># m</span>
<span class="n">reg_fraction</span> <span class="o">=</span> <span class="mf">0.032</span>  <span class="c1"># fraction of r_planet</span>
<span class="n">max_time</span> <span class="o">=</span> <span class="mi">400</span>  <span class="c1"># Myr</span>
<span class="n">temp_core_melting</span> <span class="o">=</span> <span class="mf">1200.0</span>  <span class="c1"># K</span>
<span class="n">core_cp</span> <span class="o">=</span> <span class="mf">850.0</span>  <span class="c1"># J/(kg K)</span>
<span class="n">core_density</span> <span class="o">=</span> <span class="mf">7800.0</span>  <span class="c1"># kg/m^3</span>
<span class="n">temp_init</span> <span class="o">=</span> <span class="mf">1600.0</span>  <span class="c1"># K</span>
<span class="n">temp_surface</span> <span class="o">=</span> <span class="mf">250.0</span>  <span class="c1"># K</span>
<span class="n">core_temp_init</span> <span class="o">=</span> <span class="mf">1600.0</span>  <span class="c1"># K</span>
<span class="n">core_latent_heat</span> <span class="o">=</span> <span class="mf">270_000.0</span>  <span class="c1"># J/kg</span>
<span class="n">kappa_reg</span> <span class="o">=</span> <span class="mf">5e-8</span>  <span class="c1"># m^2/s</span>
<span class="n">dr</span> <span class="o">=</span> <span class="mf">1000.0</span>  <span class="c1"># m</span>
</pre></div>
</div>
<p>As we want to model an undifferentiated body, we don’t want to include
a core in our model set up. Because we wanted it to be easy to swap
between different model set-ups, the <cite>numerical_methods.discretisation()</cite>
function still requires a core object to be instantiated. When the boundary
conditions are set up correctly, the core object does not interact with
the mantle and does not influence the cooling. Setting <cite>core_size_factor=0</cite>
can lead to scalar overflow errors, which can be avoided by setting
<cite>core_size_factor</cite> to a small, non-zero number that is smaller than the grid
spacing (so the core_temperature_array has dimension 0 along radius):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">core_size_factor</span> <span class="o">=</span> <span class="mf">0.001</span>
</pre></div>
</div>
<p>For this example, we won’t save any outputs. If you’re working
on your local machine, you can specify the folder you want to
save your outputs to, and check that this folder exists on your
machine (if it doesn’t, a folder will be created):</p>
<blockquote>
<div><p>folder = ‘workflow’
load_plot_save.check_folder_exists(folder)</p>
</div></blockquote>
<p>This folder can also be specified in the parameters file.
Any variable loaded from the parameters file can be
overwritten before the model runs, which is useful if looping over
a parameter space.</p>
<p>The <cite>setup_functions.set_up()</cite> function creates empty arrays to
be filled with resulting temperatures:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">r_core</span><span class="p">,</span>
 <span class="n">radii</span><span class="p">,</span>
 <span class="n">core_radii</span><span class="p">,</span>
 <span class="n">reg_thickness</span><span class="p">,</span>
 <span class="n">where_regolith</span><span class="p">,</span>
 <span class="n">times</span><span class="p">,</span>
 <span class="n">mantle_temperature_array</span><span class="p">,</span>
 <span class="n">core_temperature_array</span><span class="p">)</span> <span class="o">=</span> <span class="n">pytesimal</span><span class="o">.</span><span class="n">setup_functions</span><span class="o">.</span><span class="n">set_up</span><span class="p">(</span><span class="n">timestep</span><span class="p">,</span>
                                                            <span class="n">r_planet</span><span class="p">,</span>
                                                            <span class="n">core_size_factor</span><span class="p">,</span>
                                                            <span class="n">reg_fraction</span><span class="p">,</span>
                                                            <span class="n">max_time</span><span class="p">,</span>
                                                            <span class="n">dr</span><span class="p">)</span>

<span class="c1"># We define an empty list of latent heat</span>
<span class="n">latent</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<p>We can check that our “no-core” set-up has worked:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">core_temperature_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(0, 126229)
</pre></div>
</div>
<p>Next, we instantiate the core object. As explained previously,
this model set up does not include a core, but in order to make
the code as modular as possible, a core object still needs to be passed
in to the main timestepping function, <cite>numerical_methods.discretisation</cite>.
We’ve just copied across the default arguments for convenience:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">core_values</span> <span class="o">=</span> <span class="n">pytesimal</span><span class="o">.</span><span class="n">core_function</span><span class="o">.</span><span class="n">IsothermalEutecticCore</span><span class="p">(</span>
    <span class="n">initial_temperature</span><span class="o">=</span><span class="n">core_temp_init</span><span class="p">,</span>
    <span class="n">melting_temperature</span><span class="o">=</span><span class="n">temp_core_melting</span><span class="p">,</span>
    <span class="n">outer_r</span><span class="o">=</span><span class="n">r_core</span><span class="p">,</span>
    <span class="n">inner_r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">rho</span><span class="o">=</span><span class="n">core_density</span><span class="p">,</span>
    <span class="n">cp</span><span class="o">=</span><span class="n">core_cp</span><span class="p">,</span>
    <span class="n">core_latent_heat</span><span class="o">=</span><span class="n">core_latent_heat</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we define the mantle properties. The default is to have constant
values, so we don’t require any arguments for this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">mantle_conductivity</span><span class="p">,</span>
 <span class="n">mantle_heatcap</span><span class="p">,</span>
 <span class="n">mantle_density</span><span class="p">)</span> <span class="o">=</span> <span class="n">pytesimal</span><span class="o">.</span><span class="n">mantle_properties</span><span class="o">.</span><span class="n">set_up_mantle_properties</span><span class="p">()</span>
</pre></div>
</div>
<p>You can check (or change) the value of these properties after they’ve been
set up using one of the <cite>MantleProperties</cite> methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mantle_conductivity</span><span class="o">.</span><span class="n">getk</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
<p>If temperature dependent properties are used, temperature can be passed in
as an argument to return the value at that temperature.</p>
<p>We need to set up the boundary conditions for the mantle. For this example,
we’re using fixed temperature boundary conditions at the
surface, and a zero-flux condition at the bottom to ensure symmetry.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">top_mantle_bc</span> <span class="o">=</span> <span class="n">pytesimal</span><span class="o">.</span><span class="n">numerical_methods</span><span class="o">.</span><span class="n">surface_dirichlet_bc</span>
<span class="n">bottom_mantle_bc</span> <span class="o">=</span> <span class="n">pytesimal</span><span class="o">.</span><span class="n">numerical_methods</span><span class="o">.</span><span class="n">cmb_neumann_bc</span>

<span class="c1"># Now we let the temperature inside the planestesimal evolve. This is the</span>
<span class="c1"># slowest part of the code, because it has to iterate over all radii and</span>
<span class="c1"># time.</span>
<span class="c1"># This will take a minute or two!</span>
<span class="c1"># Note that this function call is the exact same as in the default constant</span>
<span class="c1"># and variable cases that included a core.</span>

<span class="p">(</span><span class="n">mantle_temperature_array</span><span class="p">,</span>
 <span class="n">core_temperature_array</span><span class="p">,</span>
 <span class="n">latent</span><span class="p">,</span>
 <span class="p">)</span> <span class="o">=</span> <span class="n">pytesimal</span><span class="o">.</span><span class="n">numerical_methods</span><span class="o">.</span><span class="n">discretisation</span><span class="p">(</span>
    <span class="n">core_values</span><span class="p">,</span>
    <span class="n">latent</span><span class="p">,</span>
    <span class="n">temp_init</span><span class="p">,</span>
    <span class="n">core_temp_init</span><span class="p">,</span>
    <span class="n">top_mantle_bc</span><span class="p">,</span>
    <span class="n">bottom_mantle_bc</span><span class="p">,</span>
    <span class="n">temp_surface</span><span class="p">,</span>
    <span class="n">mantle_temperature_array</span><span class="p">,</span>
    <span class="n">dr</span><span class="p">,</span>
    <span class="n">core_temperature_array</span><span class="p">,</span>
    <span class="n">timestep</span><span class="p">,</span>
    <span class="n">r_core</span><span class="p">,</span>
    <span class="n">radii</span><span class="p">,</span>
    <span class="n">times</span><span class="p">,</span>
    <span class="n">where_regolith</span><span class="p">,</span>
    <span class="n">kappa_reg</span><span class="p">,</span>
    <span class="n">mantle_conductivity</span><span class="p">,</span>
    <span class="n">mantle_heatcap</span><span class="p">,</span>
    <span class="n">mantle_density</span><span class="p">)</span>
</pre></div>
</div>
<p>This function fills the empty arrays produced by
<cite>setup_functions.set_up()</cite> with calculated temperatures.</p>
<p>Our next step is to calculate cooling rates for the body. Usually, we
calculate cooling rates for the mantle and the core in the same way.
As the core temperature array is empty, but we still need a
<cite>core_cooling_rates</cite> array to pass to our plotting function, we just set
<cite>core_cooling_rates = core_temperature_array</cite> to save time computing a
meaningless empty array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mantle_cooling_rates</span> <span class="o">=</span> <span class="n">pytesimal</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">cooling_rate</span><span class="p">(</span><span class="n">mantle_temperature_array</span><span class="p">,</span> <span class="n">timestep</span><span class="p">)</span>
<span class="n">core_cooling_rates</span> <span class="o">=</span> <span class="n">core_temperature_array</span>
</pre></div>
</div>
<p>To get an overview of the cooling history of the body, it’s very useful
to plot the temperatures and cooling rates as a heatmap through time.
In order to plot the results, we need to define a figure height and width,
then call <cite>load_plot_save.plot_temperature_history()</cite>,
<cite>load_plot_save.plot_coolingrate_history()</cite> or <cite>load_plot_save.two_in_one()</cite>.
These functions convert the cooling rate from K/timestep to K/Myr to make
the results more human-readable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig_w</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">fig_h</span> <span class="o">=</span> <span class="mi">9</span>

<span class="n">pytesimal</span><span class="o">.</span><span class="n">load_plot_save</span><span class="o">.</span><span class="n">two_in_one</span><span class="p">(</span>
    <span class="n">fig_w</span><span class="p">,</span>
    <span class="n">fig_h</span><span class="p">,</span>
    <span class="n">mantle_temperature_array</span><span class="p">,</span>
    <span class="n">core_temperature_array</span><span class="p">,</span>
    <span class="n">mantle_cooling_rates</span><span class="p">,</span>
    <span class="n">core_cooling_rates</span><span class="p">,)</span>
</pre></div>
</div>
<img alt="(a) Planetesimal temperatures through time, (b) Planetesimal cooling rates through time" class="sphx-glr-single-img" src="../_images/sphx_glr_no_core_001.png" />
<p>Results can be saved in the same way as for the constant and variable
properties examples.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 2 minutes  28.503 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-no-core-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/d41f2e48258af1bac4e3d18661b6e979/no_core.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">no_core.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/073cf0a127555c78750860efc151aebf/no_core.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">no_core.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="quick_start.html" class="btn btn-neutral float-right" title="Quick Start" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="constant_properties.html" class="btn btn-neutral float-left" title="Constant Properties" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Maeve Murphy Quinlan.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>